Imports System
Imports System.Collections.Generic
Imports System.Linq
Imports System.Text
Imports Newtonsoft.Json
Imports OnflxFormSchemaV1

Namespace DemonstracaoOnfluxSchema
    Module Module1

        Public Sub Main()

            Dim jsonString As String = "{ ""formSchemaVersion"": ""1"", ""customerInstance"": ""20"", ""formId"": ""376"", ""formVersion"": ""82"", ""responseId"": ""01793dd8-09c5-42ed-a950-4238313c3eab"", ""sections"": [ { ""sectionId"": ""1"", ""dateCreated"": ""08/07/2014T12:43:23.0000000"", ""elapsedTime"": 0, ""creator"": ""JOSE DAS COVES XAVIER"", ""senderDescription"": ""Aplicacao X"", ""senderPlatform"": """", ""fields"": [ { ""fieldId"": ""1"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""MARIA JOSE DA SILVA XAVIER"" }, { ""text"": ""MARIA DOS SANTOS"" } ] }, { ""fieldId"": ""15"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""28597686880"" } ] }, { ""fieldId"": ""2"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""3"", ""type"": ""DateField"", ""format"": ""dd/MM/yyyy"", ""data"": [ { ""value"": ""24/05/1959"" } ] }, { ""fieldId"": ""4"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""RUA LUIZ FERNANDO TROMBINOCEP 11533410"" } ] }, { ""fieldId"": ""5"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""201"" } ] }, { ""fieldId"": ""6"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""7"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""PQ SAO LUIZ"" } ] }, { ""fieldId"": ""8"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""CUBATAO"" } ] }, { ""fieldId"": ""9"", ""type"": ""TableField"", ""format"": null, ""data"": [ { ""selected"": ""SP"" } ] }, { ""fieldId"": ""10"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""11"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""013"" } ] }, { ""fieldId"": ""012"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""33633005"" } ] }, { ""fieldId"": ""013"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""013"" } ] }, { ""fieldId"": ""14"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""997878621"" } ] }, { ""fieldId"": ""16"", ""type"": ""DateField"", ""format"": ""dd/MM/yyyy"", ""data"": [ { ""value"": ""08/07/2014"" } ] }, { ""fieldId"": ""17"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""018"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""19"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""20"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""PACIENTE ANSIOSA PARA O TRATAMENTO, EXPLICADO COMO MANUSEAR A CANETA, LOCAIS CORRETOS DE APLICCAO, ARMAZENAMENTO DA INSULINA, TEMPO DE VENCIMENTO, IMPORTANVIA DO RODIZIO NAS APLICACOES.CUIDADO COM LIPODISTROFIA.ALIMRNTACAO, EXERCICIO QUANDL MEDICO LIBERAR.PROGRAMA STARBEM, KIT IMICIO DE TRATAMENTO.PONTOS DE VENDAS CREDENCIADOS."" } ] }, { ""fieldId"": ""21"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 40 } ] }, { ""fieldId"": ""22"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""N\u00c3O"" } ] }, { ""fieldId"": ""23"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""24"", ""type"": ""SelectionField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""25"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""26"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""27"", ""type"": ""TableField"", ""format"": null, ""data"": [ { ""selected"": ""ANLO 5MG CX 30 COMP"" }, { ""selected"": ""ENALAPRIL 20 MG C/30 CPR"" }, { ""selected"": ""LANTUS 100UI SOL INJ CX 1CARP X 3ML"" }, { ""selected"": ""LIPLESS 100MG CX 30 COMP"" }, { ""selected"": ""LOSARTANA POTASSICA 50 MG CX 30CP"" } ] }, { ""fieldId"": ""28"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 70 } ] }, { ""fieldId"": ""29"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 165 } ] }, { ""fieldId"": ""30"", ""type"": ""FormulaField"", ""format"": null, ""data"": [ { ""result"": 2571 } ] }, { ""fieldId"": ""34"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""96248"" } ] }, { ""fieldId"": ""35"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""31"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""2"" } ] }, { ""fieldId"": ""32"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""18350"" } ] }, { ""fieldId"": ""33"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""40"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""2"" } ] }, { ""fieldId"": ""37"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 32 } ] }, { ""fieldId"": ""38"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 1 } ] }, { ""fieldId"": ""39"", ""type"": ""FormulaField"", ""format"": null, ""data"": [ { ""result"": 32 } ] }, { ""fieldId"": ""083"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""41"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""42"", ""type"": ""NumericField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""43"", ""type"": ""NumericField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""44"", ""type"": ""FormulaField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""36"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 5 } ] }, { ""fieldId"": ""45"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""46"", ""type"": ""DateField"", ""format"": ""dd/MM/yyyy"", ""data"": [ { ""value"": ""08/07/2001"" } ] }, { ""fieldId"": ""47"", ""type"": ""TextField"", ""format"": null, ""data"": [ { ""text"": ""ANA PAULA LINS DE SOUZA"" } ] }, { ""fieldId"": ""48"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 40530 } ] }, { ""fieldId"": ""49"", ""type"": ""TableField"", ""format"": null, ""data"": [ { ""selected"": ""SP"" } ] }, { ""fieldId"": ""50"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""6"" } ] }, { ""fieldId"": ""51"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""052"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""2"" } ] }, { ""fieldId"": ""53"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""054"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""055"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""056"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""57"", ""type"": ""NumericField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""58"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""059"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""60"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""61"", ""type"": ""SelectionField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""062"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""63"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 740 } ] }, { ""fieldId"": ""064"", ""type"": ""ImageField"", ""format"": null, ""data"": [ { ""image"": ""https://onflux-v1-blobs.s3-sa-east-1.amazonaws.com/AZ/376/8490/OFXP20-GUID_9973225.jpg?AWSAccessKeyId=AKIAJ2AS6SUWRLK7RAVA&Expires=1406120510&Signature=ZrwTlQpzj2UDPsiTdmnMiUMTgA8%3D"", ""format"": ""URL"", ""thumbnail"": """" } ] }, { ""fieldId"": ""65"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""66"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""67"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""1"" } ] }, { ""fieldId"": ""68"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""69"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""70"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""71"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""82"", ""type"": ""SelectionField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""72"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""388"" }, { ""selected"": ""387"" }, { ""selected"": ""386"" }, { ""selected"": ""385"" }, { ""selected"": ""384"" } ] }, { ""fieldId"": ""73"", ""type"": ""TextField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""74"", ""type"": ""NumericField"", ""format"": null, ""data"": [ { ""number"": 32 } ] }, { ""fieldId"": ""75"", ""type"": ""NumericField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""76"", ""type"": ""NumericField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""77"", ""type"": ""NumericField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""78"", ""type"": ""NumericField"", ""format"": null, ""data"": [] }, { ""fieldId"": ""079"", ""type"": ""SelectionField"", ""format"": null, ""data"": [ { ""selected"": ""0"" } ] }, { ""fieldId"": ""80"", ""type"": ""TextField"", ""format"": null, ""data"": [] } ] } ]}"

            Dim objform As Form
            objform = JsonConvert.DeserializeObject(Of Form)(jsonString)


            Console.WriteLine("Id do Formulário: " & objform.formId)
            Console.WriteLine("Versão do schema: " & objform.formSchemaVersion)
            Console.WriteLine("Versão do Formulário: " & objform.formVersion)
            Console.WriteLine("Quantidade de campos: " & objform.sections(0).fields.Count)
            Console.WriteLine("Breakpoint aqui, para não fechar a nanela DOS na IDE")
        End Sub


    End Module
End Namespace

