using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Newtonsoft.Json;
using OnflxFormSchemaV1;

namespace DemonstracaoOnfluxSchema
{
    class Program
    {
        static void Main(string[] args)
        {

            //Dados de um formulário onflux para teste
            String jsonString = "{\n \"formSchemaVersion\": \"1\",\n \"customerInstance\": \"20\",\n \"formId\": \"376\",\n \"formVersion\": \"82\",\n \"responseId\": \"01793dd8-09c5-42ed-a950-4238313c3eab\",\n \"sections\": [\n {\n \"sectionId\": \"1\",\n \"dateCreated\": \"08/07/2014T12:43:23.0000000\",\n \"elapsedTime\": 0,\n \"creator\": \"JOSE DAS COVES XAVIER\",\n \"senderDescription\": \"Aplicacao X\",\n \"senderPlatform\": \"\",\n \"fields\": [\n {\n \"fieldId\": \"1\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"MARIA JOSE DA SILVA XAVIER\"\n },\n {\n \"text\": \"MARIA DOS SANTOS\"\n }\n ]\n },\n {\n \"fieldId\": \"15\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"28597686880\"\n }\n ]\n },\n {\n \"fieldId\": \"2\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"3\",\n \"type\": \"DateField\",\n \"format\": \"dd/MM/yyyy\",\n \"data\": [\n {\n \"value\": \"24/05/1959\"\n }\n ]\n },\n {\n \"fieldId\": \"4\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"RUA LUIZ FERNANDO TROMBINOCEP 11533410\"\n }\n ]\n },\n {\n \"fieldId\": \"5\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"201\"\n }\n ]\n },\n {\n \"fieldId\": \"6\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"7\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"PQ SAO LUIZ\"\n }\n ]\n },\n {\n \"fieldId\": \"8\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"CUBATAO\"\n }\n ]\n },\n {\n \"fieldId\": \"9\",\n \"type\": \"TableField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"SP\"\n }\n ]\n },\n {\n \"fieldId\": \"10\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"11\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"013\"\n }\n ]\n },\n {\n \"fieldId\": \"012\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"33633005\"\n }\n ]\n },\n {\n \"fieldId\": \"013\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"013\"\n }\n ]\n },\n {\n \"fieldId\": \"14\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"997878621\"\n }\n ]\n },\n {\n \"fieldId\": \"16\",\n \"type\": \"DateField\",\n \"format\": \"dd/MM/yyyy\",\n \"data\": [\n {\n \"value\": \"08/07/2014\"\n }\n ]\n },\n {\n \"fieldId\": \"17\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"018\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"19\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"20\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"PACIENTE ANSIOSA PARA O TRATAMENTO, EXPLICADO COMO MANUSEAR A CANETA, LOCAIS CORRETOS DE APLICCAO, ARMAZENAMENTO DA INSULINA, TEMPO DE VENCIMENTO, IMPORTANVIA DO RODIZIO NAS APLICACOES.CUIDADO COM LIPODISTROFIA.ALIMRNTACAO, EXERCICIO QUANDL MEDICO LIBERAR.PROGRAMA STARBEM, KIT IMICIO DE TRATAMENTO.PONTOS DE VENDAS CREDENCIADOS.\"\n }\n ]\n },\n {\n \"fieldId\": \"21\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 40\n }\n ]\n },\n {\n \"fieldId\": \"22\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"N\u00c3O\"\n }\n ]\n },\n {\n \"fieldId\": \"23\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"24\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"25\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"26\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"27\",\n \"type\": \"TableField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"ANLO 5MG CX 30 COMP\"\n },\n {\n \"selected\": \"ENALAPRIL 20 MG C/30 CPR\"\n },\n {\n \"selected\": \"LANTUS 100UI SOL INJ CX 1CARP X 3ML\"\n },\n {\n \"selected\": \"LIPLESS 100MG CX 30 COMP\"\n },\n {\n \"selected\": \"LOSARTANA POTASSICA 50 MG CX 30CP\"\n }\n ]\n },\n {\n \"fieldId\": \"28\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 70\n }\n ]\n },\n {\n \"fieldId\": \"29\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 165\n }\n ]\n },\n {\n \"fieldId\": \"30\",\n \"type\": \"FormulaField\",\n \"format\": null,\n \"data\": [\n {\n \"result\": 2571\n }\n ]\n },\n {\n \"fieldId\": \"34\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"96248\"\n }\n ]\n },\n {\n \"fieldId\": \"35\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"31\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"2\"\n }\n ]\n },\n {\n \"fieldId\": \"32\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"18350\"\n }\n ]\n },\n {\n \"fieldId\": \"33\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"40\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"2\"\n }\n ]\n },\n {\n \"fieldId\": \"37\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 32\n }\n ]\n },\n {\n \"fieldId\": \"38\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 1\n }\n ]\n },\n {\n \"fieldId\": \"39\",\n \"type\": \"FormulaField\",\n \"format\": null,\n \"data\": [\n {\n \"result\": 32\n }\n ]\n },\n {\n \"fieldId\": \"083\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"41\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"42\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"43\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"44\",\n \"type\": \"FormulaField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"36\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 5\n }\n ]\n },\n {\n \"fieldId\": \"45\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"46\",\n \"type\": \"DateField\",\n \"format\": \"dd/MM/yyyy\",\n \"data\": [\n {\n \"value\": \"08/07/2001\"\n }\n ]\n },\n {\n \"fieldId\": \"47\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": [\n {\n \"text\": \"ANA PAULA LINS DE SOUZA\"\n }\n ]\n },\n {\n \"fieldId\": \"48\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 40530\n }\n ]\n },\n {\n \"fieldId\": \"49\",\n \"type\": \"TableField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"SP\"\n }\n ]\n },\n {\n \"fieldId\": \"50\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"6\"\n }\n ]\n },\n {\n \"fieldId\": \"51\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"052\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"2\"\n }\n ]\n },\n {\n \"fieldId\": \"53\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"054\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"055\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"056\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"57\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"58\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"059\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"60\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"61\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"062\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"63\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 740\n }\n ]\n },\n {\n \"fieldId\": \"064\",\n \"type\": \"ImageField\",\n \"format\": null,\n \"data\": [\n {\n \"image\": \"https://onflux-v1-blobs.s3-sa-east-1.amazonaws.com/AZ/376/8490/OFXP20-GUID_9973225.jpg?AWSAccessKeyId=AKIAJ2AS6SUWRLK7RAVA&Expires=1406120510&Signature=ZrwTlQpzj2UDPsiTdmnMiUMTgA8%3D\",\n \"format\": \"URL\",\n \"thumbnail\": \"\"\n }\n ]\n },\n {\n \"fieldId\": \"65\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"66\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"67\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"1\"\n }\n ]\n },\n {\n \"fieldId\": \"68\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"69\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"70\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"71\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"82\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"72\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"388\"\n },\n {\n \"selected\": \"387\"\n },\n {\n \"selected\": \"386\"\n },\n {\n \"selected\": \"385\"\n },\n {\n \"selected\": \"384\"\n }\n ]\n },\n {\n \"fieldId\": \"73\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"74\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": [\n {\n \"number\": 32\n }\n ]\n },\n {\n \"fieldId\": \"75\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"76\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"77\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"78\",\n \"type\": \"NumericField\",\n \"format\": null,\n \"data\": []\n },\n {\n \"fieldId\": \"079\",\n \"type\": \"SelectionField\",\n \"format\": null,\n \"data\": [\n {\n \"selected\": \"0\"\n }\n ]\n },\n {\n \"fieldId\": \"80\",\n \"type\": \"TextField\",\n \"format\": null,\n \"data\": []\n }\n ]\n }\n ]\n}"; 
            
            //Deserializa JSon para classe .Net
            Form form = JsonConvert.DeserializeObject<Form>(jsonString, new JsonSerializerSettings { TypeNameHandling = TypeNameHandling.Auto, MetadataPropertyHandling = MetadataPropertyHandling.ReadAhead});

            //Add some custom data for testing
            form.formCustomData.Add(new FormCustomDataItem("CustomDataExample", "123456"));

            
            //Exibe campos para mostrar que funcionou
            Console.WriteLine("Id do Formulário: " + form.formId);
            Console.WriteLine("Versão do schema: " + form.formSchemaVersion);
            Console.WriteLine("Versão do Formulário: " + form.formVersion);
            Console.WriteLine("Quantidade de campos: " + form.sections[0].fields.Count);
            Console.WriteLine("CustomDataExample: " + form.formCustomData[0].value);
            Console.WriteLine("Breakpoint aqui, para não fechar a nanela DOS na IDE"); 
        }
    }
}
